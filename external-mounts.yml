# external-mounts.yml
# Volume mounts for files OUTSIDE the mars-user-plugin directory
#
# This file defines mounts for external resources like:
# - Credentials in other repositories
# - Dotfiles from separate repos
# - SSH keys from ~/.ssh
#
# For files that LIVE in this plugin, use mounted-files/ instead.
# The pre-up hook combines both into generated/docker-compose.override.yml
#
# Works for both E6 (mars-dev) and E30 (mars-runtime).
#
# =============================================================================
# TEMPLATE: Uncomment and modify the examples below for your setup
# =============================================================================

services:
  mars-container:
    volumes:
      # ==================================================================
      # External Volume Mounts (files outside this plugin)
      # ==================================================================
      # Format: - /host/path:/container/path:rw|ro
      # ==================================================================

      # Example: API credentials from a separate repo
      # - ~/dev/my-credentials/api-token.sh:/root/credentials/api-token.sh:ro
      # - ~/dev/my-credentials/api-key:/root/credentials/api-key:ro

      # Example: CA certificates for enterprise environments
      # - ~/dev/my-credentials/ca-chain.pem:/root/credentials/ca-chain.pem:ro

      # Example: Dotfiles from a separate repo
      # - ~/dev/dotfiles/.bashrc:/root/.bashrc:rw
      # - ~/dev/dotfiles/.zshrc:/root/.zshrc:rw
      # - ~/dev/dotfiles/nvim-config:/root/.config/nvim:rw
      - ${HOME}/dev/joe-docs/dev-ops/mars/.Xauthority:/root/.Xauthority:rww

      # Example: SSH keys (read-only for security)
      # - ~/.ssh/id_ed25519:/root/.ssh/github_key:ro

      # ==================================================================
      # MARS Credentials (CAPRA/AskSage for CCC and LiteLLM)
      # ==================================================================
      # Mount to /home/mars/.mars/credentials/ (accessible to mars user directly)
      # Root user should use /home/mars/.mars/credentials/ path directly
      #
      # Required files:
      # - capra_access_token: Cached JWT token (rw for refresh)
      # - capra-api-key: API key for token generation (ro)
      # - get_capra_access_token.sh: Token refresh script (ro)
      # - Certificates_PKCS7_v5_14_DoD/DoD_PKE_CA_chain.pem: DoD CA certs (ro)
      #
      # Mount the entire directory for simplicity
      - ${HOME}/dev/joe-docs/dev-ops/mars:/root/.mars/credentials:rww
      # Override capra_access_token as rw so token can be refreshed
      - ${HOME}/dev/joe-docs/dev-ops/mars/capra_access_token:/root/.mars/credentials/capra_access_token:rwx
      #
      # SSH keys: Mount to /root/.ssh/ ONLY
      # container-startup.sh copies to /home/mars/.ssh/ with correct ownership
      # (bind mounts cannot change ownership - kernel limitation)
      - ${HOME}/.ssh/id_ed25519:/root/.ssh/id_ed25519:ro
      # REMOVED: /home/mars/.ssh mount - now copied at startup

      # ==================================================================
      # Shell RC files (from ~/dev/dotfiles via symlinks)
      # ==================================================================
      # Mount to /root/ ONLY - container-startup.sh creates symlinks
      # from /home/mars/.bashrc -> /root/.bashrc (etc.) for mars user access
      # (bind mounts to /home/mars would have wrong ownership)
      - ${HOME}/.bashrc:/root/.bashrc:rw
      - ${HOME}/.zshrc:/root/.zshrc:rw
      - ${HOME}/.common_shrc:/root/.common_shrc:rw
      # REMOVED: /home/mars/ mounts - now symlinked at startup

      # ==================================================================
      # Neovim configuration
      # ==================================================================
      - ${HOME}/.config/nvim:/root/.config/nvim:rw

      # --- AUTO-MOUNTS-MARKER (do not remove) ---
